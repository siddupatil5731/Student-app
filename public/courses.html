<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>My Courses</title>
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <div class="container">
    <h2>Your Courses</h2>
    
    <div id="courses-container">
      <!-- Courses will be loaded here -->
    </div>
    
    <a href="login.html" class="logout-link">Logout</a>
  </div>

  <script src="/js/script.js"></script>
  <script>
    const email = new URLSearchParams(window.location.search).get('email');
    const coursesContainer = document.getElementById('courses-container');
    
    // Load courses
    function loadCourses() {
      fetch('/student-courses/' + encodeURIComponent(email))
        .then(res => res.json())
        .then(courses => {
          coursesContainer.innerHTML = '';
          
          if (courses.length === 0) {
            coursesContainer.innerHTML = '<p class="text-center">No courses registered yet.</p>';
            return;
          }
          
          courses.forEach(course => {
            const courseItem = document.createElement('div');
            courseItem.className = 'course-item';
            courseItem.innerHTML = `
              <div class="course-info">
                <h4>${course.courseName}</h4>
                <p>Teacher: ${course.teacher}</p>
              </div>
              <div class="course-actions">
                <button class="btn-action btn-delete" data-id="${course._id}">Remove</button>
              </div>
            `;
            coursesContainer.appendChild(courseItem);
          });
          
          // Add event listeners for delete buttons
          document.querySelectorAll('.btn-delete').forEach(btn => {
            btn.addEventListener('click', deleteCourse);
          });
        });
    }
    
    // Remove course
    function deleteCourse(e) {
      if (!confirm('Are you sure you want to remove this course?')) return;
      
      const courseId = e.target.dataset.id;
      
      fetch(`/student-courses/${courseId}`, {
        method: 'DELETE',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({ email })
      })
      .then(res => {
        if (res.ok) {
          loadCourses();
        } else {
          alert('Error removing course');
        }
      });
    }
    
    // Load courses when page loads
    loadCourses();
  </script>
</body>
</html>
